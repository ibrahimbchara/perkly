<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Perkly Admin</title>
  <link rel="stylesheet" href="/styles.css" />
</head>
<body>
  <main class="layout admin-layout">
    <header class="hero compact">
      <div class="badge">Admin</div>
      <h1>Perkly Card Upload</h1>
      <p class="lead">Use one Excel template to update all cards at once.</p>
      <a class="link" href="/">Back to matcher</a>
    </header>

    <section class="flow">
      <div class="card-block">
        <h2>Download template</h2>
        <p class="hint">This Excel follows the same structure as your original file, with extra columns for calculation rules.</p>
        <div class="actions">
          <a class="link" href="/admin/cards/export-excel">Download current Excel</a>
        </div>
        <p class="hint">Add or edit cards directly in the Excel, then upload to replace the database.</p>
      </div>

      <div class="card-block">
        <h2>Upload Excel</h2>
        <form class="admin-form" method="post" action="/admin/cards/import-excel" enctype="multipart/form-data">
          <div class="input-row full">
            <label>Upload Excel (.xlsx)</label>
            <input type="file" name="cards_excel" accept=".xlsx,.xls" required />
          </div>
          <div class="actions">
            <button class="btn primary" type="submit">Upload and replace cards</button>
          </div>
        </form>
        <p class="hint">Upload replaces the full card database. Keep column names unchanged.</p>
        <p class="hint">Spend buckets used in Earn Rules JSON: travel, retail, utilities, food_groceries, fuel, transportation, real_estate, foreign.</p>
      </div>
    </section>
  </main>
</body>
</html>
